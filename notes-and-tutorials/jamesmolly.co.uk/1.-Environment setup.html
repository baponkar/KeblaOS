<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0109)./1.-Environment%20setup.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><!-- is_embed=False -->
<script src="./1.-Environment setup_files/ca-pub-2761421417962228.js.download"></script><script>
  const observer = new PerformanceObserver((list) => {
    list.getEntries().forEach((entry) => {
      console.log('%o', entry);
    })
  });
  observer.observe({type: "navigation", buffered: true});
</script>
<script src="./1.-Environment setup_files/athena.js.download" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app202.us.archive.org';v.server_ms=385;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="./1.-Environment setup_files/bundle-playback.js.download" charset="utf-8"></script>
<script type="text/javascript" src="./1.-Environment setup_files/wombat.js.download" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="./1.-Environment setup_files/ruffle.js.download"></script>
<script type="text/javascript">
    __wm.init("https://web.archive.org/web");
  __wm.wombat("http://jamesmolloy.co.uk/tutorial_html/1.-Environment%20setup.html","20160326062945","https://web.archive.org/","web","/_static/",
	      "1458973785");
</script>
<link rel="stylesheet" type="text/css" href="./1.-Environment setup_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="./1.-Environment setup_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->
<title>1.-Environment setup</title><link rel="stylesheet" type="text/css" href="./1.-Environment setup_files/highlight.css"><link rel="stylesheet" type="text/css" href="./1.-Environment setup_files/layout.css"></head><body data-new-gr-c-s-check-loaded="14.1086.0" data-gr-ext-installed=""><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;"><template shadowrootmode="closed"><div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;" class="">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20160326062945/http%3A//jamesmolloy.co.uk/tutorial_html/1.-Environment%2520setup.html" scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="https://web.archive.org/web/" title="Wayback Machine home page"><img src="https://web.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0"></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="https://web.archive.org/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://jamesmolloy.co.uk/tutorial_html/1.-Environment%20setup.html" onfocus="this.focus();this.select();" style="flex:1;" autocomplete="off"><input type="hidden" name="type" value="replay"><input type="hidden" name="date" value="20160326062945"><input type="submit" value="Go">
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
                <div class="s" id="wm-nav-captures" style="flex:1;"><a class="t" href="https://web.archive.org/web/*/http://jamesmolloy.co.uk/tutorial_html/1.-Environment%20setup.html" title="See a list of every capture for this URL">156 captures</a><div class="r" title="Timespan for captures of this URL">19 Oct 2007 - 6 Dec 2022</div></div>
        <div class="k">
          <a href="https://web.archive.org/web/20040201000000/http://jamesmolloy.co.uk/tutorial_html/1.-Environment%20setup.html" id="wm-graph-anchor">
            <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
              <canvas id="wm-sparkline-canvas" width="725" height="27" border="0"></canvas>
            <div class="yt" style="display: none; width: 25px; height: 27px; left: 200px;"></div><div class="mt" style="display: none; width: 2px; height: 27px; left: 203px;"></div></div>
          </a>
        </div>
      </div>
    </div>
    <div class="n">
      <table>
        <tbody>
          <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
          <tr class="m">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20160218174950/http://www.jamesmolloy.co.uk:80/tutorial_html/1.-Environment%20setup.html" title="18 Feb 2016"><strong>Feb</strong></a></td>
            <td class="c" id="displayMonthEl" title="You are here: 06:29:45 Mar 26, 2016">Mar</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20160921091003/http://www.jamesmolloy.co.uk:80/tutorial_html/1.-Environment%20setup.html" title="21 Sep 2016"><strong>Sep</strong></a></td>
          </tr>
          <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
          <tr class="d">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20160320203120/http://www.jamesmolloy.co.uk:80/tutorial_html/1.-Environment%20setup.html" title="20:31:20 Mar 20, 2016"><img src="https://web.archive.org/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0"></a></td>
            <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 06:29:45 Mar 26, 2016">26</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20160408171631/http://www.jamesmolloy.co.uk:80/tutorial_html/1.-Environment%20setup.html" title="17:16:31 Apr 08, 2016"><img src="https://web.archive.org/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0"></a></td>
          </tr>
          <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
          <tr class="y">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20150227172928/http://www.jamesmolloy.co.uk:80/tutorial_html/1.-Environment%20setup.html" title="27 Feb 2015"><strong>2015</strong></a></td>
            <td class="c" id="displayYearEl" title="You are here: 06:29:45 Mar 26, 2016">2016</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20170416185605/http://www.jamesmolloy.co.uk/tutorial_html/1.-Environment%20setup.html" title="16 Apr 2017"><strong>2017</strong></a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
                <span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="./1.-Environment%20setup.html#" title="Share via My Web Archive" style="display: none;">
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in" style="display: inline-block;">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web" style="display: none;"></span>
        </span>
                <a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
        <a id="wm-tb-close" href="./1.-Environment%20setup.html#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="https://web.archive.org/web/20160326062945/http://web.archive.org/screenshot/http://jamesmolloy.co.uk/tutorial_html/1.-Environment%20setup.html" id="wm-screenshot" title="screenshot" style="visibility: hidden;">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="./1.-Environment%20setup.html#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
        <a id="wm-share-facebook" href="./1.-Environment%20setup.html#" data-url="./1.-Environment%20setup.html" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
        <a id="wm-share-twitter" href="./1.-Environment%20setup.html#" data-url="./1.-Environment%20setup.html" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
        <a id="wm-expand" class="wm-btn wm-closed" href="./1.-Environment%20setup.html#expand"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
        <div id="wm-capinfo-notice" source="api"></div>
                <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/web)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/web" target="_new"><span class="wm-title">web</span></a></div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="https://web.archive.org/_static/images/loading.gif" alt="loading"></div>
    </div>
    </div>
  </div></div></div><link rel="stylesheet" type="text/css" href="./1.-Environment setup_files/banner-styles.css"><link rel="stylesheet" type="text/css" href="./1.-Environment setup_files/iconochive.css"><div class="wb-autocomplete-suggestions "></div></template>
</div><div id="wm-ipp-print">The Wayback Machine - ./1.-Environment%20setup.html</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(725,27,25,2,"web","http://jamesmolloy.co.uk/tutorial_html/1.-Environment%20setup.html","20160326062945",1996,"/_static/",["/_static/css/banner-styles.css?v=S1zqJCYt","/_static/css/iconochive.css?v=3PDvdIFv"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 <div class="header">
<div style="float: right;">
      <script type="text/javascript"><!--
google_ad_client = "pub-2761421417962228";
/* 468x60, created 22/05/08 */
google_ad_slot = "5309073637";
google_ad_width = 468;
google_ad_height = 60;
//-->
      </script>
      <script type="text/javascript" src="./1.-Environment setup_files/f.txt">
      </script><ins id="aswift_0_expand" style="display:inline-table;border:none;height:60px;margin:0;padding:0;position:relative;visibility:visible;width:468px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:60px;margin:0;padding:0;position:relative;visibility:visible;width:468px;background-color:transparent"><iframe width="468" height="60" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" data-ruffle-polyfilled="" src="./1.-Environment setup_files/saved_resource.html"></iframe></ins></ins>
    </div>
	www.jamesmolloy.co.uk
	<div class="header_subtitle">
		<a href="https://web.archive.org/web/20160326062945/http://www.jamesmolloy.co.uk/index.html">Home</a> �
	 	JamesM's kernel development tutorials
	</div>
</div>
<div class="main_frame">

<div class="index">
<a href="./1.-Environment%20setup.html" class="selected">1. Environment setup</a><br><a href="./2.-Genesis.html">2. Genesis</a><br><a href="./3.-The%20Screen.html">3. The Screen</a><br><a href="./4.-The%20GDT%20and%20IDT.html">4. The GDT and IDT</a><br><a href="./5.-IRQs%20and%20the%20PIT.html">5. IRQs and the PIT</a><br><a href="./6.-Paging.html">6. Paging</a><br><a href="./7.-The%20Heap.html">7. The Heap</a><br><a href="./8.-The%20VFS%20and%20the%20initrd.html">8. The VFS and the initrd</a><br><a href="./9.-Multitasking.html">9. Multitasking</a><br><a href="./10.-User%20Mode.html">10. User Mode</a><br></div>
<h1>1. Environment setup</h1>
<p>We need a base from which to design and make our kernel. Here I will
be assuming that you are using a *nix system, with the GNU
toolchain. If you want to use a windows system, you must either use
cygwin (which is a *nix emulation environment) or DJGPP. Either way,
the makefiles and commands in this tutorial may not work.
</p>
<p></p><h2>1.1. Directory structure</h2>
<p>My directory is laid out as follows:
</p>
<p></p><div class="code">
tutorial<br>
&nbsp;|<br>
&nbsp;+--&nbsp;src<br>
&nbsp;|<br>
&nbsp;+--&nbsp;docs
</div>
<p></p>
<p>All your source files will go in src, and all your documentation (you
do write documentation? ;) ) should go in docs.
</p>
<p></p><h2>1.2. Compiling</h2>
<p>The examples in this tutorial should compile successfully with the GNU
toolchain (gcc, ld, gas, etc). The assembly examples are written in
intel syntax, which is (my personal opinion) a much more
human-readable syntax than the AT&amp;T; syntax that GNU AS uses. To
assemble these, you will need the <a href="https://web.archive.org/web/20160326062945/http://nasm.sourceforge.net/">Netwide Assembler</a>.
</p>
<p>This tutorial is <i>not</i> a bootloader tutorial. We will be using
<a href="https://web.archive.org/web/20160326062945/http://www.gnu.org/software/grub">GRUB</a> to load our kernel. To do this, we
need a floppy disk image with GRUB preloaded onto it. There are
<a href="./tutorials">tutorials</a> to do this, but, happily, I have made a standard image,
which can be found <a href="https://web.archive.org/web/20160326062945/http://jamesmolloy.co.uk/downloads/floppy.img">here</a>. This goes in your 'tutorial' (or whatever
you named it) directory.
</p>
<p></p><h2>1.3. Running</h2>
<p>There is no alternative for bare hardware as a testbed
system. Unfortunately, bare hardware is pretty pants at telling you
where things went wrong (but of course, you're going to write
completely bug-free code first time, aren't you?). Enter
<a href="https://web.archive.org/web/20160326062945/http://www.bochs.sourceforge.net/">Bochs</a>. Bochs is an open-source x86-64
emulator. When things go completely awry, bochs will tell you, and
store the processor state in a logfile, which is extremely
useful. Also it can be run and rebooted much faster than a real
machine. My examples will be made to run well on bochs.
</p>
<p></p><h2>1.4. Bochs</h2>
<p>In order to run bochs, you are going to need a bochs configuration
file (bochsrc.txt). Coincidentally, a sample one is included below!
</p>
<p>Take care with the locations of the bios files. These seem to change
between installations, and if you made bochs from source it is very
likely you don't even have them. Google their filenames, you can get
them from the official bochs site among others.
</p>
<p></p><div class="code">
megs:&nbsp;32<br>
romimage:&nbsp;file=/usr/share/bochs/BIOS-bochs-latest,&nbsp;address=0xf0000<br>
vgaromimage:&nbsp;/usr/share/bochs/VGABIOS-elpin-2.40<br>
floppya:&nbsp;1_44=/dev/loop0,&nbsp;status=inserted<br>
boot:&nbsp;a<br>
log:&nbsp;bochsout.txt<br>
mouse:&nbsp;enabled=0<br>
clock:&nbsp;sync=realtime<br>
cpu:&nbsp;ips=500000
</div>
<p></p>
<p>This will make bochs emulate a 32MB machine with a clock speed similar
to a 350MHz PentiumII. The instructions per second can be cranked up -
I prefer a slower emulation speed, simply so I can see what is going
on if lots of text is being scrolled.
</p>
<p></p><h2>1.5. Useful scripts</h2>
<p>We are going to be doing several things very often - making (compiling
and linking) our project, and transferring the resulting kernel binary
to our floppy disk image.
</p>
<p></p><h3>1.5.1. Makefile</h3>
<p></p><div class="code">
<span class="code_comment"># Makefile for JamesM's kernel tutorials.</span><br>
<span class="code_comment"># The C and C++ rules are already setup by default.</span><br>
<span class="code_comment"># The only one that needs changing is the assembler </span><br>
<span class="code_comment"># rule, as we use nasm instead of GNU as.</span><br>
<br>
<span class="code_variable">SOURCES</span>=boot.o<br>
<br>
<span class="code_variable">CFLAGS</span>=<br>
<span class="code_variable">LDFLAGS</span>=-Tlink.ld<br>
<span class="code_variable">ASFLAGS</span>=-felf<br>
<br>
<span class="code_label">all:</span>&nbsp;$(<span class="code_variable">SOURCES</span>)&nbsp;link&nbsp;<br>
<br>
<span class="code_label">clean:</span><br>
&nbsp;�&nbsp;	-<span class="code_primitive">rm</span>&nbsp;*.o&nbsp;kernel<br>
<br>
<span class="code_label">link:</span><br>
&nbsp;�&nbsp;	ld&nbsp;$(<span class="code_variable">LDFLAGS</span>)&nbsp;-o&nbsp;kernel&nbsp;$(<span class="code_variable">SOURCES</span>)<br>
<br>
.s<span class="code_label">.o:</span><br>
&nbsp;�&nbsp;	nasm&nbsp;$(<span class="code_variable">ASFLAGS</span>)&nbsp;$<span class="code_operator">&lt;</span>
</div>
<p></p>
<p>This Makefile will compile every file in SOURCES, then link them
together into one ELF binary, 'kernel'. It uses a linker script,
'link.ld' to do this:
</p>
<p></p><h3>1.5.2. Link.ld</h3>
<p></p><div class="code">
/*&nbsp;Link.ld&nbsp;--&nbsp;Linker&nbsp;script&nbsp;for&nbsp;the&nbsp;kernel&nbsp;-&nbsp;ensure&nbsp;everything&nbsp;goes&nbsp;in&nbsp;the&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Correct&nbsp;place.&nbsp;&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Original&nbsp;file&nbsp;taken&nbsp;from&nbsp;Bran's&nbsp;Kernel&nbsp;Development&nbsp;*/<br>
/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tutorials:&nbsp;http://www.osdever.net/bkerndev/index.php.&nbsp;*/<br>
<br>
ENTRY(start)<br>
SECTIONS<br>
{<br>
&nbsp;&nbsp;.text&nbsp;0x100000&nbsp;:<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;=&nbsp;.;&nbsp;_code&nbsp;=&nbsp;.;&nbsp;__code&nbsp;=&nbsp;.;<br>
&nbsp;&nbsp;&nbsp;&nbsp;*(.text)<br>
&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;=&nbsp;ALIGN(4096);<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;.data&nbsp;:<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;.;&nbsp;_data&nbsp;=&nbsp;.;&nbsp;__data&nbsp;=&nbsp;.;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(.data)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(.rodata)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;=&nbsp;ALIGN(4096);<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;.bss&nbsp;:<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;bss&nbsp;=&nbsp;.;&nbsp;_bss&nbsp;=&nbsp;.;&nbsp;__bss&nbsp;=&nbsp;.;<br>
&nbsp;&nbsp;&nbsp;&nbsp;*(.bss)<br>
&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;=&nbsp;ALIGN(4096);<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;end&nbsp;=&nbsp;.;&nbsp;_end&nbsp;=&nbsp;.;&nbsp;__end&nbsp;=&nbsp;.;<br>
}
</div>
<p></p>
<p>This script tells LD how to set up our kernel image. Firstly it tells
LD that the start location of our binary should be the symbol 'start'.
It then tells LD that the .text section (that's where all your code
goes) should be first, and should start at 0x100000 (1MB). The .data
(initialised static data) and the .bss (uninitialised static data)
should be next, and each should be page-aligned (ALIGN(4096)).
Linux GCC also adds in an extra data section: .rodata. This is for
read-only initialised data, such as constants. For simplicity we
simply bundle this in with the .data section.
</p>
<p></p><h3>1.5.3. update_image.sh</h3>
<p>A nice little script that will poke your new kernel binary into the
floppy image file (This assumes you have made a directory /mnt). Note:
you will need /sbin in your $PATH to use losetup.
</p>
<p></p><div class="code">
<span class="code_comment">#!/bin/bash</span><br>
<br>
<span class="code_primitive">sudo</span>&nbsp;<span class="code_primitive">losetup</span>&nbsp;/dev/loop0&nbsp;floppy.img<br>
<span class="code_primitive">sudo</span>&nbsp;<span class="code_primitive">mount</span>&nbsp;/dev/loop0&nbsp;/mnt<br>
<span class="code_primitive">sudo</span>&nbsp;<span class="code_primitive">cp</span>&nbsp;src/kernel&nbsp;/mnt/kernel<br>
<span class="code_primitive">sudo</span>&nbsp;<span class="code_primitive">umount</span>&nbsp;/dev/loop0<br>
<span class="code_primitive">sudo</span>&nbsp;<span class="code_primitive">losetup</span>&nbsp;-d&nbsp;/dev/loop0
</div>
<p></p>
<p></p><h3>1.5.4. run_bochs.sh</h3>
<p>This script will setup a loopback device, run bochs on it, then
disconnect it.
</p>
<p></p><div class="code">
<span class="code_comment">#!/bin/bash</span><br>
<br>
<span class="code_comment"># run_bochs.sh</span><br>
<span class="code_comment"># mounts the correct loopback device, runs bochs, then unmounts.</span><br>
<br>
<span class="code_primitive">sudo</span>&nbsp;/sbin/<span class="code_primitive">losetup</span>&nbsp;/dev/loop0&nbsp;floppy.img<br>
<span class="code_primitive">sudo</span>&nbsp;bochs&nbsp;-f&nbsp;bochsrc.txt<br>
<span class="code_primitive">sudo</span>&nbsp;/sbin/<span class="code_primitive">losetup</span>&nbsp;-d&nbsp;/dev/loop0
</div>
<p></p>
<p></p></div>
<div class="footer">Copyright James Molloy 2008 - james&lt;at&gt;jamesmolloy.co.uk</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://web.archive.org/web/20160326062945/https://ssl." : "https://web.archive.org/web/20160326062945/http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./1.-Environment setup_files/ga.js.download" type="text/javascript"></script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3513903-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>

<img id="translator-icon" src="chrome-extension://ifbamokmfkcnhbpeokkochdpecopfccd/icons/icon-128.png" style="display: none;"><div id="translator-container" style="display: none;">
<div class="rapid-header">
  <img src="chrome-extension://ifbamokmfkcnhbpeokkochdpecopfccd/icons/logo.svg">
  <img id="rapid-copy" src="chrome-extension://ifbamokmfkcnhbpeokkochdpecopfccd/icons/copy.svg">
</div><div id="rapid-text-wrapper"><span></span></div>

<div class="rapid-footer">
  <span id="rapid-first-language">ENG</span>
  <img id="rapid-arrow-icon" src="chrome-extension://ifbamokmfkcnhbpeokkochdpecopfccd/icons/r-arrow.svg">
  <span id="rapid-second-language">FRN</span>
</div></div></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;limited&quot;,&quot;isActive&quot;:false,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>